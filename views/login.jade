// extends layout


doctype html
html(lang='en')
  head
    title Welcome to Common Sync
    meta(charset='utf-8')
    meta(name='viewport', content='width=device-width, initial-scale=1')
    link(rel='stylesheet', href='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css')
    script(src='https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js')
    script(src='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js')
  body(style="background-color: #bbbcbf")
    nav.navbar.navbar-inverse
      .container-fluid
        .navbar-header
          a.navbar-brand(href='/') Common Sync
        ul.nav.navbar-nav.navbar-right
          li
            a(href='/')
              span.glyphicon.glyphicon-exit
              |  Cancel
         

    .main.container(style="margin-top: 5%")
      .row
        .col-md-6.col-md-offset-3
          h1.display-4.m-b-2 Log In
          form(method='POST' onSubmit='checkform();')
            div.email
              label(for='email') Email
              input.form-control(type='text' id='email' placeholder='email' name='email' required)
            div.password
              label(for='password') Password
              input.form-control(type='password' id='password' placeholder='password' name='password' required)
            button.btn.btn-primary(type='submit' onclick="checkform();") Log in 
  
    script.
      function checkform(){
        var password = document.getElementById("password").value;
        var email = document.getElementById("email").value;
        
        var inputs = document.getElementsByTagName("input");
        
        for (var i = 0; i < inputs.length; i++) {
            // only validate the inputs that have the required attribute
            if(inputs[i].hasAttribute("required")){
              if(inputs[i].value == ""){
                // found an empty field that is required
                alert("Please fill all required fields");
                return false;
              }
              else if(/[^a-zA-Z0-9@]/.test(inputs[i].value)) {
                alert('Input must be alphanumeric');
                return false;
              }
            }
        }
        accessDB(password, email);
        // todo: try and get the page to redirect after verifying the login
        location.href="index";
      }
      
      // todo: verify the user exists in firebase and return true or false
      function accessDB(password, email){
      
        return true;
      }
