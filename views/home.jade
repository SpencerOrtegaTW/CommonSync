extends layout

head
  title #{title}
  
  link(rel='stylesheet', href='https://fonts.googleapis.com/icon?family=Material+Icons')
style.

      main {margin:0;}
      
      body{
        background: #333;
        font-family: 'Open Sans', sans-serif;
      }
      
      table, th, td {
        border: 5px solid black;
        border-collapse: collapse;
      }

      
block content
  .main.container
    //navigation bar code 
    
    div.navbar
        #myTopnav.topnav
          a.active(href='#home') Home
          |   
          a(href='createProject') Create Project
          |   
          a(href='#about') Account
          |   
          a.icon(href='javascript:void(0);', style='font-size:15px;', onclick='myFunction()') &#x2630;
          button.dropbtn(onclick='dropdown()') &#x2630
            #myDropdown.dropdown-content 
              a(href='#home') Settings
              br
              a(href='#about') Logout
              br
   div.home_page_body
    body
      section#main_feed
         h1 Main Feed
         p stuff will go here
         
          script.
            console.log("nav bar loading...")
              // When the user clicks on the dropdown button,
              //toggle between hiding and showing the dropdown content 
              
              function dropdown() {
                  console.log("dropdown function triggered");
                  document.getElementById("myDropdown").classList.toggle("show");
                  console.log("dropdown function success")
                  }
                // Close the dropdown if the user clicks outside of it
                
              window.onclick = function(event) {
                  if (!event.target.matches('.dropbtn')) {
                  var dropdowns = document.getElementsByClassName("dropdown-content");
                  var i;
                  for (i = 0; i < dropdowns.length; i++) {
                  var openDropdown = dropdowns[i];
                  if (openDropdown.classList.contains('show')) {
                  openDropdown.classList.remove('show');
                  }
                  }
                  }
                  }
                console.log("done.");
     //everything after the navigation bar 
  
    div.home_page_body
      body
        section#search_bar
          .wrap
            .search
              input.searchTerm(type='text', placeholder='Search Projects By Tags', size='35', name='pTags')
              button.searchButton(type='submit' onclick='saveTags()') &#x1F50D
        section#main_feed
          h1(align="center") Projects
          | Sort by: 
          select#sortMenu
           option(value='popular') Popular
           |     
           option(value='relevant') Relevant
           |  
           option(value='abc') Alphabetical
           |     
           option(value='recent') Recent
          br
          div(style='display:flex;')
            div(style='overflow:scroll;height:500px;width:100%;overflow:auto;')
             table#main_table
            aside#main_sidebar
              h1#sidebarT Sidebar 
              p#sidebarP more stuff will go here 
        
      //here we define the functions for the search bar, the sorting menu, and the buttons. Also programatically populate the feed with project posts from the database.
    
    script.
        function saveTags(){
          // If the user doesn't enter anything into the field and clicks the search button, don't search!
          var emptyField = document.getElementsByName("pTags")[0].value;
          if(emptyField == null || emptyField == ""){
            return false;
          }
          var tags = document.getElementsByName("pTags")[0].value.split(' ');
          // have to access db to pull project info based on tag matches from array
          returnProjects(tags);
          var list = [
            { title: 'Underwater Basket Weaving', description: 'thishhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhh'},
            { title: 'Some Dope Ass Project', description: 'is a'},
            { title: 'Competetive Napping', description: 'test'}
          ];
          for(x in list){
            addRow(list[x]);
          }
        }
        
        function addRow(x){
          console.log(x);
          var table = document.getElementById("main_table");
          
          var rowCount = table.rows.length;
          var row = table.insertRow(rowCount);
          
          var data = document.createElement("td");
          
          // todo: load database title into this variable
          var postTitle = x.title;
          var strong = document.createElement("strong");
          var sample = document.createTextNode(postTitle);
          strong.appendChild(sample);
          data.appendChild(strong);
          
          // todo: load database description into this variable
          var dbDesc = x.description;
          var para = document.createElement("p");
          para.setAttribute('style', 'max-width:900px; word-wrap:break-word');
          var description = document.createTextNode(dbDesc);
          para.appendChild(description);
          data.appendChild(para);
          
          var add = document.createElement("button");
          add.innerHTML = "Add to Interests";
          add.addEventListener ("click", function() {
            // add the tags to users collection of interests in the db
            document.getElementById("sidebarT").innerHTML = "Project Description";
            document.getElementById("sidebarP").innerHTML = dbDesc;
            document.getElementById("sidebarP").setAttribute('style', 'max-width:200px; word-wrap:break-word');
            alert(sample.nodeValue);
          });
          data.appendChild(add);
          
          var join = document.createElement("button");
          join.innerHTML = "Join Project";
          join.addEventListener ("click", function() {
            // add user name to project collection of collaborators
            // may have to get username from cookie here
            alert(description.nodeValue);
          });
          data.appendChild(join);
          
          row.appendChild(data);
          
          table.appendChild(row);
        }
        
        function returnProjects(tags){
          
        }
        